---
/**
 * ExperienceList Component
 * Renders list of experience cards with intersection observer animations
 */
import ExperienceCard from '@components/Sections/Experience/ExperienceCard.astro';
import { EXPERIENCES } from '@constants/experiences';
---

{EXPERIENCES.map((experience, index) => (
  <ExperienceCard {...experience} index={index} />
))}

<script>
  const observerOptions = {
    root: null,
    rootMargin: '-5% 0px -10% 0px',
    threshold: 0.15,
  };

  const experienceObserver = new IntersectionObserver((entries) => {
    entries.forEach((entry, index) => {
      if (entry.isIntersecting) {
        const itemIndex = parseInt(entry.target.getAttribute('data-index') || '0');
        setTimeout(() => {
          entry.target.classList.add('visible');
        }, itemIndex * 100);
        experienceObserver.unobserve(entry.target);
      }
    });
  }, observerOptions);

  document.querySelectorAll('.experience-card-container').forEach((item) => {
    experienceObserver.observe(item);
  });
</script>
