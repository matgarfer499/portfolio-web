---
import SectionLayout from "@layouts/SectionLayout.astro";
import SectionTitle from "@components/UI/SectionTitle.astro";
import ExperienceCard from "@components/UI/ExperienceCard.astro";
import { EXPERIENCES } from "@constants/experiences";
---

<SectionLayout>
  <div id="experience">
    <SectionTitle title="Experience" />

    <div class="experience-container mx-auto">
      {
        EXPERIENCES.map((experience, index) => (
          <ExperienceCard {...experience} index={index} />
        ))
      }
    </div>

    <!-- View Full Resume Link -->
    <div class="flex justify-start mt-12 mb-12 max-w-5xl mx-auto text-blue-500">
      <a
        href="/cv.pdf"
        target="_blank"
        class="group inline-flex items-center gap-2 font-semibold hover:text-neutral-600 dark:hover:text-neutral-400 transition-colors duration-200"
      >
        <span>View Full Résumé</span>
      </a>
    </div>
  </div>
</SectionLayout>

<script>
  // Intersection Observer for experience cards
  const observerOptions = {
    root: null,
    rootMargin: "-10% 0px -10% 0px",
    threshold: 0.1,
  };

  const experienceObserver = new IntersectionObserver((entries) => {
    entries.forEach((entry) => {
      if (entry.isIntersecting) {
        entry.target.classList.add("visible");
      }
    });
  }, observerOptions);

  // Observe all experience cards
  document.querySelectorAll(".experience-card-container").forEach((item) => {
    experienceObserver.observe(item);
  });
</script>
