---
import type { Experience } from "../../types/experience";
import Tag from "./Tag.astro";
import LinkedIn from "@components/Icons/LinkedIn.astro";

interface Props extends Experience {
  index: number;
}

const {
  company,
  logo,
  position,
  startDate,
  endDate,
  description,
  current,
  technologies,
  index,
} = Astro.props;
---

<div
  class="experience-card-container opacity-0 transform translate-y-8 transition-all duration-700 ease-out first:pt-0 py-8 border-b last:border-b-0"
  style="border-color: var(--color-primary-dark);"
  data-index={index}
>
  <!-- Header Row: Title | Logo | Date -->
  <div class="flex items-center justify-between gap-6 mb-4">
    <!-- Position Title and Company -->
    <div class="flex-1 flex items-center justify-start gap-2">
      <h3 class="text-xl font-semibold" style="color: var(--color-primary-dark);">
        {position} ·
      </h3>
      <div class="flex-shrink-0">
        <div class="w-24 h-12 flex items-center justify-center">
          <img
            src={logo}
            alt={`${company} logo`}
            class="w-full h-full object-contain"
          />
        </div>
      </div>
    </div>

    <!-- Date Range -->
    <div
      class="text-sm uppercase tracking-wide whitespace-nowrap"
      style="color: var(--color-primary);"
    >
      {startDate} — {current ? "Present" : endDate}
    </div>
  </div>

  <!-- Description -->
  <p
    class="text-sm leading-relaxed mb-4"
    style="color: var(--color-text-muted);"
  >
    {description}
  </p>

  <!-- Technologies Tags -->
  {
    technologies && technologies.length > 0 && (
      <div class="flex flex-wrap gap-2">
        {technologies.map((tech) => (
            <Tag label={tech} icon={LinkedIn} variant="tech" />
        ))}
      </div>
    )
  }
</div>

<style>
  .experience-card-container.visible {
    opacity: 1;
    transform: translateY(0);
  }

  .experience-card-container:nth-child(even) {
    transition-delay: 0.1s;
  }

  .experience-card-container:nth-child(odd) {
    transition-delay: 0.2s;
  }
</style>
