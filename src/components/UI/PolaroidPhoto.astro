---
import { Image } from "astro:assets";

const {
  src,
  alt,
  caption,
  rotation = 0,
  zIndex = 1,
  index,
  offsetX = 0,
  offsetY = 0,
} = Astro.props;
---

<div
  class="polaroid-card absolute w-56 h-72 p-3 pb-10 cursor-grab select-none active:cursor-grabbing"
  style="background-color: var(--color-primary-lightest); transform: rotate(${rotation}deg); z-index: ${zIndex}; left: ${offsetX}px; top: ${offsetY}px; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3), 0 2px 4px rgba(0, 0, 0, 0.2), 0 10px 20px rgba(0, 0, 0, 0.4);"
  data-index={index}
>
  <div
    class="polaroid-image-container w-full aspect-square overflow-hidden mb-2 pointer-events-none relative"
    style="background-color: var(--color-primary-lighter); box-shadow: inset 0 2px 8px rgba(0,0,0,0.15), inset 0 1px 4px rgba(0,0,0,0.1);"
  >
    <div class="polaroid-reveal-overlay absolute inset-0 z-10" style="background-color: var(--color-primary-lightest);"></div>
    <Image
      src={src}
      alt={alt}
      width={224}
      height={224}
      class="polaroid-image w-full h-full object-cover block pointer-events-none opacity-0"
      draggable="false"
    />
  </div>
  <p
    class="text-center text-sm mt-2 leading-relaxed pointer-events-none font-['Courier_New',monospace]"
    style="color: var(--color-primary-darker);"
  >
    {caption}
  </p>
</div>

<style>
  .polaroid-reveal-overlay {
    transition: opacity 1.5s ease-out;
  }

  .polaroid-image {
    transition: opacity 1.5s ease-out;
  }

  .polaroid-card.revealing .polaroid-reveal-overlay {
    opacity: 0;
  }

  .polaroid-card.revealing .polaroid-image {
    opacity: 1;
  }
</style>
